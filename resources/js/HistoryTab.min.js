$(function(){var e=config.VersionControl;$("#VersionControlHistory").on("click",".history-tab__button--edit-comment",function(){var t=$(this).parent("td").prev("td"),i=$(this).data("revision"),o=prompt(e.i18n.commentPrompt,t.text());return null!==o&&$.post(e.processPage+"comment",{revision:i,comment:o},function(e){t.text(e).effect("highlight",{},500)}),!1}),$("#VersionControlHistory").on("change","#history_filters select",function(e){var t="";$(this).parents("#history_filters:first").find("input, select").each(function(){t&&(t+="&"),t+=$(this).attr("name")+"="+$(this).val(),e.stopPropagation()}),window.location.search=t});var t=$("#VersionControlHistory");t.length&&t.children("ul:first").data("active")&&$("#_"+t.attr("id")).trigger("click"),$("#ProcessPageEdit").on("submit",function(){$(this).find("#history_filters").remove()}),t.on("click",".history-tab__button--preview",function(){var e=$(this);return $("body").append('<div id="preview-overlay"></div>').append('<div id="preview"><iframe src="'+e.attr("href")+'" seamless></iframe></div>'),$("#preview iframe").on("load",function(t){$("#preview").addClass("loaded"),$(t.target.contentWindow).on("beforeunload",function(t){t.preventDefault(),i(e)})}),$("#preview-overlay").fadeIn(),$("#preview").show().animate({right:0},500,function(){$("body").addClass("version-control--preview")}),$(document).on("keyup.preview",function(){i(e)}).on("click.preview",function(){i(e)}),!1});var i=function(e){return $(window).off("blur.preview"),$(document).off("keyup.preview"),$(document).off("click.preview"),$("body").removeClass("version-control--preview"),$("#preview-overlay").fadeOut(function(){$(this).remove()}),$("#preview").animate({right:"-80%"},500,function(){$(this).remove()}),e.parents("tr:first").effect("highlight",{},1500),!1};t.on("click",".history-tab__button--restore",function(){return confirm(e.i18n.confirmRestore)})});